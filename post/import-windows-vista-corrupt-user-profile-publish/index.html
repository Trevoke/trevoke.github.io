<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Windows Vista : Corrupt user profile - Seven steps</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Aldric Giacomoni" /><meta name="description" content="I&#39;m taking this from this page but thought I should try to propagate it a little since it took me forever to find it.
 Assume in this example that the username is &#39;atiensivu&#39;, the domain is &#39;staff&#39;, and the user profile is located in %systemdrive%\users\atiensivu. %systemdrive% is typically C: on standard Vista installs. Replace every instance &#39;atiensivu&#39; with the username of the corrupt profile.  If you can log into the profile, make note of the %USERPROFILE% environment variable value." /><meta name="keywords" content="programming, martial arts, phlosophy, elixir, ruby, tdd, test-driven design, agile, xp, extreme programming, process" />






<meta name="generator" content="Hugo 0.52 with even 4.0.0" />


<link rel="canonical" href="http://blog.trevoke.net/post/import-windows-vista-corrupt-user-profile-publish/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Windows Vista : Corrupt user profile" />
<meta property="og:description" content="I&#39;m taking this from this page but thought I should try to propagate it a little since it took me forever to find it.
 Assume in this example that the username is &#39;atiensivu&#39;, the domain is &#39;staff&#39;, and the user profile is located in %systemdrive%\users\atiensivu. %systemdrive% is typically C: on standard Vista installs. Replace every instance &#39;atiensivu&#39; with the username of the corrupt profile.  If you can log into the profile, make note of the %USERPROFILE% environment variable value." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://blog.trevoke.net/post/import-windows-vista-corrupt-user-profile-publish/" /><meta property="article:published_time" content="2008-12-07T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2008-12-07T00:00:00&#43;00:00"/>

<meta itemprop="name" content="Windows Vista : Corrupt user profile">
<meta itemprop="description" content="I&#39;m taking this from this page but thought I should try to propagate it a little since it took me forever to find it.
 Assume in this example that the username is &#39;atiensivu&#39;, the domain is &#39;staff&#39;, and the user profile is located in %systemdrive%\users\atiensivu. %systemdrive% is typically C: on standard Vista installs. Replace every instance &#39;atiensivu&#39; with the username of the corrupt profile.  If you can log into the profile, make note of the %USERPROFILE% environment variable value.">


<meta itemprop="datePublished" content="2008-12-07T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2008-12-07T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="265">



<meta itemprop="keywords" content="windows,vista,user-profile,corrupt," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Windows Vista : Corrupt user profile"/>
<meta name="twitter:description" content="I&#39;m taking this from this page but thought I should try to propagate it a little since it took me forever to find it.
 Assume in this example that the username is &#39;atiensivu&#39;, the domain is &#39;staff&#39;, and the user profile is located in %systemdrive%\users\atiensivu. %systemdrive% is typically C: on standard Vista installs. Replace every instance &#39;atiensivu&#39; with the username of the corrupt profile.  If you can log into the profile, make note of the %USERPROFILE% environment variable value."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Seven Steps</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Seven Steps</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Windows Vista : Corrupt user profile</h1>

      <div class="post-meta">
        <span class="post-time"> 2008-12-07 </span>
        
          <span class="more-meta"> 265 words </span>
          <span class="more-meta"> 2 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    
  </div>
</div>
    <div class="post-content">
      <p>I'm taking this from <a href="http://blog.tiensivu.com/aaron/archives/932-Dealing-with-corrupt-user-profiles-in-Vista-and-saving-the-contents.html" target="_blank">this page</a> but thought I should try to propagate it a little since it took me forever to find it.</p>

<ol>
Assume in this example that the username is 'atiensivu', the domain is 'staff', and the user profile is located in %systemdrive%\users\atiensivu. %systemdrive% is typically C: on standard Vista installs. Replace every instance 'atiensivu' with the username of the corrupt profile.
<!--more-->
<li>If you can log into the profile, make note of the %USERPROFILE% environment variable value. Most likely it will be 'C:\Users\atiensivu' or 'C:\Users\atiensivu.staff'. Logoff.</li>
</ol>

<ol>
<li>If you have logged in with the profile at any point since your last reboot or you suspect there are files in use within the profile, reboot. The important part is to make sure there are no open files within the broken profile directory.</li>
</ol>

<ol>
<li>Login as administrator or another account with local admin rights.</li>
</ol>

<ol>
<li>Run 'takeown /r /a /d y /f %systemdrive%\users\atiensivu'.</li>
(Note : before doing step 4, remove things like the IE cache if you can, save yourself some time).
<li>From %systemdrive%\users, rename 'atiensivu' to 'atiensivu.old'.</li>
</ol>

<ol>
<li>Within %systemdrive%\users, create a directory called 'atiensivu'.</li>
</ol>

<ol>
<li>Run 'takeown /r /u staff\atiensivu /f %systemdrive%\users\atiensivu'.</li>
</ol>

<ol>
<li>Run regedit and go to HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList and delete the SID key for the corrupt profile. Easiest way to find the correct SID is to search from the 'ProfileList' key for the directory mentioned in %USERPROFILE% in step #1.</li>
</ol>

<ol>
<li>Logoff.</li>
</ol>

<ol>
<li>Log into the 'atiensivu' account. A new profile should be created. Copy over any files you might want from the old profile directory.</li>
</ol>

<p>The 'takeown' commands might be overkill but I don't like getting permission errors.</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Aldric Giacomoni</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2008-12-07
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/windows/">windows</a>
          <a href="/tags/vista/">vista</a>
          <a href="/tags/user-profile/">user-profile</a>
          <a href="/tags/corrupt/">corrupt</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/import-more-students-testing-publish/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">More students testing</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/import-martial-arts-while-sick-publish/">
            <span class="next-text nav-default">Martial arts while sick</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:trevoke@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/users/234025/trevoke" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/trevoke" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.linkedin.com/in/trevoke/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/trevoke/" class="iconfont icon-github" title="github"></a>
      <a href="https://getpocket.com/@Trevoke" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://gitlab.com/trevoke" class="iconfont icon-gitlab" title="gitlab"></a>
  <a href="http://blog.trevoke.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">&copy; <a href="https://github.com/trevoke">Aldric Giacomoni</a> 2017-2019</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>








</body>
</html>
